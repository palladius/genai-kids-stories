<div id="<%= dom_id story %>">
  <h2>
      <%= link_to "📝", edit_story_path(story) %>
    <strong><%= link_to render_story_title(story), story %></strong>
  </h2>

      <%#= image_tag(story.cover_image.variant(:thumb)) if story.cover_image.attached? %>
      <%= image_tag(story.cover_image,  style: "float:right;height:200px;") if story.cover_image.attached? %>

      <%#= link_to story.cover_image.filename, story.cover_image if story.cover_image.attached? %>

    <i><%= story.genai_summary %></i>

    <% story.paragraphs.each_with_index do |p, ix|  %>
  <p>
    🔸 <%= ix+1 %> <%= p %>
  </p>
    <% end  %>

<h3>StoryParagraph</h3>

  <%= render 'stories/obsolete_pointer' %>

  # story_paragraphs: <b><%= story.story_paragraphs.size  %></b>

  See them here: <%= link_to "story_paragraphs for Story.#{story.id}",  "/story_rebuilt/#{story.id}" %><br/>

  <% StoryParagraph.available_lanugages.each do |language| %>
    - <%= link_to "🚧 OBSOLETE 🚧 Translate to #{language}", "/story_rebuilt/#{@story.id}?translate_to=#{language}", method: :post %><br/>
  <% end if  story.story_paragraphs.size  == 0 %>

<h3><%= TranslatedStory.emoji %> Translated Stories</h3>

<% already_translated = []
   TranslatedStory.where(story_id: @story.id).each do |ts|
     already_translated <<ts.language
%>
  ✅  Already translated <%= ts.flag %> <%= link_to( ts, ts )%> <br/>
<% end %>
<% StoryParagraph.available_lanugages.each do |language|
unless already_translated.include?(language)
# https://stackoverflow.com/questions/2695538/add-querystring-parameters-to-link-to
%>
  <%#= link_to "TranslateS to #{waving_flag language}", "/translated_stories/new?story_id=#{@story.id}&translate_to=#{language}&language=#{language}&name=autocreated&internal_notes=autocreated", method: :post %><br/>
  ❌ Missing: <%= link_to "Translate to #{waving_flag language}",
# https://stackoverflow.com/questions/15410895/rails-ruby-prepopulate-form-with-data-passed-from-another-page
    new_translated_story_path(
      { #:id => 42,
      #"translated_story[language]".to_sym => 'bohg',
      #"translated_story[internal_notes]".to_sym => 'mahahahahah',
      #"translated_story[internal_notes]" => 'mahahahahah no sym',
      :story_id => @story.id,
      :story => @story,
      :language => language,
      :internal_notes => "#{@story.title} -- Created from _story.html AppVersion=#{APP_VERSION}",
      :name => 'TODO new_translated_story_path',
      'translated_story[name]' => 'nome 1',
      'translated_story[name]'.to_sym => 'nome2',
      },
      #:class => "debug btn btn-primary"
    )#, method: :post
    %>
<% end
end  %>


<h3>📈 Story Stats</h3>

<% %w{genai_summary genai_input genai_output internal_notes }.each do |xxx| %>
 -📈 Size:  :<b><%=story.send(xxx).size rescue '?' %></b>B <%= xxx %> <br/>
<% end %>
-📈 cover_image Attached:  :<b><%=story.cover_image.attached? %></b>
<% if story.cover_image.attached? and story.cover_image.analyzed? %>
<!-- (file: <%= story.cover_image %>) -->
(metadata: <%= link_to 'todo', 'https://stackoverflow.com/questions/60130926/activestorage-get-image-dimensions-after-upload' %>
) <% end %>
<br/>
-📈 additional_images Attached:  :<b><%=story.additional_images.attached? %></b><br/>



<br/>

<h3>Debug info</h3>
  <h4>genai_input</h4>
  <pre><%= story.genai_input %></pre>

  <h4>internal_notes</h4>
  <pre><%= story.internal_notes %></pre>

  <h4>Image debug info</h4>

  <p class='debug'>
    <strong>CoverImage info:</strong>
    <pre><%= JSON.pretty_generate story.attached_stuff_info %></pre>
  </p>

<hr/>

<h3>👶 About Kiddo</h3>
  <p>
    <%= image_tag(story.kid.avatar, style: "float:left;height:100px;") if story.kid.avatar.attached? %>

    <strong>
     <%= link_to story.kid,story.kid %>
    </strong>
  </p>
</div>
